DROP TABLE `phptest`.`models__index`
CREATE VIEW `models__index_view` AS SELECT modelName, numRules, totN, trainN, testN, positives, negatives, TP, TN, FP, FN, accuracy, sensitivity, specificity, PPV, NPV  FROM `models__index` ORDER BY `tableName` ASC
DO RANDOMIZE!

- quella cosa del testo e newlines
- terapia ormonale con secondo livello
  terapia osteoprotettiva con secondo livello
  le altre no.


? FRATTURA_FEMORE dovrebbe essere un checkbox+value, ma non esiste il relativo campo checkbox. Secondo te in Anamnesi.FRATTURA_FEMORE, i NULL equivalgono in realta' a una nuova classe "0"?
	SELECT DISTINCT FRATTURA_FEMORE FROM `Anamnesi` 
? FRATTURA_SITI_DIVERSI_ALTRO, trasformare in binario. e' un campo di testo, faccio binary bag of words.
	SELECT DISTINCT FRATTURA_SITI_DIVERSI,FRATTURA_SITI_DIVERSI_ALTRO FROM `Anamnesi` 
? Diagnosi.SITUAZIONE_FEMORE_SN_CHECKBOX, Diagnosi.SITUAZIONE_FEMORE_DX_CHECKBOX: ho trovato un referto dove entrambi i femori sono (entrambi osteoporotici). (E casi 20 dove nessun femore e' fratturato)!
	SELECT Diagnosi.ID, Diagnosi.SITUAZIONE_FEMORE_SN_CHECKBOX, Diagnosi.SITUAZIONE_FEMORE_SN, Diagnosi.SITUAZIONE_FEMORE_DX_CHECKBOX, Diagnosi.SITUAZIONE_FEMORE_DX, IF(Diagnosi.SITUAZIONE_FEMORE_SN_CHECKBOX, Diagnosi.SITUAZIONE_FEMORE_SN, IF(Diagnosi.SITUAZIONE_FEMORE_DX_CHECKBOX, Diagnosi.SITUAZIONE_FEMORE_DX, 'Normale')) FROM `Diagnosi` WHERE (ISNULL(SITUAZIONE_FEMORE_SN) AND ISNULl(SITUAZIONE_FEMORE_DX)) OR (SITUAZIONE_FEMORE_SN = SITUAZIONE_FEMORE_DX)
? "Pazienti.SESSO = 'F'"
? cosa e' COLONNA_PARZ_NON_ANALIZZABILE?
? applicabile: Diagnosi.FRAX_APPLICABILE fa diventare il frax NULL ?
? errore: //$db_fit->addInputColumn("ID_RACCOMANDAZIONE_TERAPEUTICA");
? segnalo probabile errore nel tipo della colonna Anamnesi.TERAPIA_OSTEOPROTETTIVA_SPECIFICA. dovrebbe essere tinyint
? questione OSTEOPOROSI_GRAVE
? supporto, confidenza, poi derivi la bonta' (Relevance and reliability thresholds). TODO Domanda: perche' ogni regola va valutata (supporto e confidence) contro l'intero set di istanze di testing, dimenticandosi dell'ordine delle regole? TODO use non-weighted counterparts?
? come mai non risolviamo come insieme?



#####################################################
SELECT COUNT(*),
TBS_COLONNA_APPLICABILE,
TBS_COLONNA_PERCENTUALE,
TBS_COLONNA_VALORE,
IF(Diagnosi.TBS_COLONNA_APPLICABILE,0+IF(Diagnosi.TBS_COLONNA_PERCENTUALE, 0, TBS_COLONNA_VALORE),NULL)

FROM `Diagnosi` GROUP BY
TBS_COLONNA_APPLICABILE,
TBS_COLONNA_PERCENTUALE,
TBS_COLONNA_VALORE,
IF(Diagnosi.TBS_COLONNA_APPLICABILE,0+IF(Diagnosi.TBS_COLONNA_PERCENTUALE, 0, TBS_COLONNA_VALORE),NULL)

#####################################################

- solve the prediction on one-column-more-attributes.
	then maybe hardcode in the sql that a given column must have that value, at prediction time?

- provide method for creating arbitrary attributes:
- provide method for creating column categorical from a checkbox+value pair of attrs, with reverse=false flag:
	create attribute "FRATTURA_VERTEBRE" from 
	Anamnesi.FRATTURA_VERTEBRE_CHECKBOX
	Anamnesi.FRATTURA_VERTEBRE
- map
- merge di due o piu colonne in un solo attributo (situazione_femore_sn,dx), in piu' forza categorico (left and right hip)


- TODO don't recurse when the outcome is false... NO_thing is not entirely safe
TODO: at prediction time just interrogate the database once and then use that same row for every level

- NLPTools http://php-nlp-tools.com/documentation/transformations.html http://php-nlp-tools.com/documentation/tokenizers.html

- test con piu' livelli (e.g quantita')
// TODO bow possibility to specify the langage for each column
// TODO stemming in italiano
